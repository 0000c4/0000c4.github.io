{"ast":null,"code":"import { makeAutoObservable } from 'mobx';\nimport AuthService from '../services/auth-service';\nimport noteService from '../services/note-service';\nimport localdb from '../local_db/localdb';\nexport default class Store {\n  constructor() {\n    //auth data\n    this.user = {};\n    this.isAuth = false;\n    //notes data\n    this.notes = [];\n    this.searchedNotes = [];\n    makeAutoObservable(this);\n  }\n  setAuth(auth) {\n    this.isAuth = auth;\n  }\n  setUser(user) {\n    this.user = user;\n  }\n  setNotes(notes) {\n    this.notes = notes;\n  }\n  setSearchedNotes(notes) {\n    this.searchedNotes = notes;\n  }\n  async login(email, password) {\n    try {\n      const response = await AuthService.login(email, password);\n      console.log(response);\n      localStorage.setItem('token', response.accessToken);\n      this.setAuth(true);\n      this.setUser(response.user);\n      this.getNotes();\n    } catch (error) {\n      return error.response.data;\n    }\n  }\n  async registration(email, password, name) {\n    try {\n      const response = await AuthService.registration(email, password, name);\n      console.log(response);\n      localStorage.setItem('token', response.accessToken);\n      this.setAuth(true);\n      this.setUser(response.user);\n    } catch (error) {\n      return error.response.data;\n    }\n  }\n  async logout() {\n    try {\n      console.log('logout');\n      await AuthService.logout();\n      localStorage.removeItem('token');\n      this.setAuth(false);\n      this.setUser({});\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  async checkAuth() {\n    try {\n      this.getNotes();\n      const response = await AuthService.checkAuth();\n      localStorage.setItem('token', response.accessToken);\n      this.setAuth(true);\n      this.setUser(response.user);\n      if (this.isAuth) {\n        //если пользователь залогинен, запустить синхронизацию с сервером\n        await this.syncWithServer();\n      }\n    } catch (error) {}\n  }\n  async sendResetPasswordEmail(email) {\n    try {\n      const response = await AuthService.sendResetPasswordEmail(email);\n      console.log(response);\n    } catch (error) {\n      return error.response.data;\n    }\n  }\n\n  //notes\n  async getNotes() {\n    const LocalNotes = await localdb.getAll();\n    console.log(LocalNotes);\n    this.setNotes(LocalNotes); //независимо от доступности сервера берем заметки из localdb\n    noteService.get().then(res => {\n      //если сервер доступен проверяем нет ли новых заметок от сервера, если есть добавляем в бд и обновляем ьассив\n      if (res.status == 200) {\n        res.data.forEach(async serverNote => {\n          //проходимся по каждой заметки из сервера и проверяем по _id есть ли она в локальной бд\n          const isSynced = LocalNotes.find(element => element._id == serverNote._id);\n          if (isSynced == undefined) await localdb.put({\n            ...serverNote,\n            status: 'sync'\n          });\n        });\n        this.setNotes(LocalNotes);\n      }\n    });\n  }\n  async editNote(note, sync) {\n    try {\n      //await service.noteChange(editedNote)\n      localdb.put({\n        ...note,\n        status: 'edit'\n      }); //сначала изменяем заметку в локалбд и стейте, если сервер доступен синхронизируемся с ним\n      this.setNotes(this.notes.map(elem => elem._id == note._id ? elem = note : elem));\n      noteService.edit(note).then(res => {\n        if (res.status == 200) {\n          localdb.put({\n            ...res.data,\n            status: 'sync'\n          });\n        }\n      });\n    } catch (error) {\n      console.log(error);\n    } finally {}\n  }\n  async AddNote(note, sync) {\n    try {\n      // setIsSync(true)\n      const localNote = {\n        ...note,\n        status: 'new',\n        _id: new Date()\n      }; //сначала создаем заметку в бд\n      await localdb.put(localNote);\n      this.setNotes([...this.notes, localNote]);\n      noteService.add(note).then(res => {\n        //если сервер доступен удаляем заметку из notes и меняем ее на валидную\n        if (res.status == 200) {\n          const syncNote = res.data;\n          const notes = this.notes.filter(e => e._id !== localNote._id);\n          localdb.delete(localNote._id);\n          localdb.put({\n            ...syncNote,\n            status: 'sync'\n          });\n          this.setNotes([...notes, syncNote]);\n        }\n      });\n    } catch (error) {\n      console.log(error);\n    } finally {\n      //setIsSync(false)\n    }\n  }\n  async RemoveNote(note, sync) {\n    try {\n      await noteService.delete(note);\n      const notes = this.notes.filter(e => e._id !== note._id);\n      this.setNotes(notes);\n    } catch (error) {}\n  }\n  async syncWithServer() {\n    noteService.get().then(async res => {\n      //если сервер доступен синхронизируем локалбд и сервер\n      if (res.status == 200) {\n        const localNotes = await localdb.getAll(); //получаем заметки из локалдб и проверяем их статус синхронизации\n        localNotes.forEach(async note => {\n          if (note.status == 'edit') {\n            const SyncedEdit = await noteService.edit(note);\n            if (SyncedEdit.status == 200) {\n              console.log('its work');\n              await localdb.put({\n                ...SyncedEdit.data,\n                status: 'sync'\n              });\n            }\n          } else if (note.status == 'new') {\n            const SyncedNew = await noteService.add(note);\n            if (SyncedNew.status == 200) {\n              await localdb.delete(note._id);\n              await localdb.put({\n                ...SyncedNew.data,\n                status: 'sync'\n              });\n            }\n          }\n        });\n      }\n    });\n  }\n  NoteSearch(search) {\n    const notes = this.notes.filter(note => note.title.toLowerCase().includes(search.toLowerCase())).concat(this.notes.filter(note => note.body.toLowerCase().includes(search.toLowerCase())));\n    this.setSearchedNotes(notes);\n  }\n}","map":{"version":3,"names":["makeAutoObservable","AuthService","noteService","localdb","Store","constructor","user","isAuth","notes","searchedNotes","setAuth","auth","setUser","setNotes","setSearchedNotes","login","email","password","response","console","log","localStorage","setItem","accessToken","getNotes","error","data","registration","name","logout","removeItem","checkAuth","syncWithServer","sendResetPasswordEmail","LocalNotes","getAll","get","then","res","status","forEach","serverNote","isSynced","find","element","_id","undefined","put","editNote","note","sync","map","elem","edit","AddNote","localNote","Date","add","syncNote","filter","e","delete","RemoveNote","localNotes","SyncedEdit","SyncedNew","NoteSearch","search","title","toLowerCase","includes","concat","body"],"sources":["C:/Users/vasja/coding/notes_pwa/src/store/Store.js"],"sourcesContent":["import { makeAutoObservable } from 'mobx';\r\nimport AuthService from '../services/auth-service';\r\nimport noteService from '../services/note-service';\r\nimport localdb from '../local_db/localdb';\r\nexport default class Store {\r\n    //auth data\r\n    user = {};\r\n    isAuth = false;\r\n\r\n    //notes data\r\n    notes = [];\r\n    searchedNotes = [];\r\n\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    setAuth(auth) {\r\n        this.isAuth = auth;\r\n    }\r\n    setUser(user) {\r\n        this.user = user;\r\n    }\r\n\r\n    setNotes(notes) {\r\n        this.notes = notes;\r\n    }\r\n    setSearchedNotes(notes) {\r\n        this.searchedNotes = notes;\r\n    }\r\n\r\n    async login(email, password) {\r\n        try {\r\n            const response = await AuthService.login(email, password);\r\n            console.log(response);\r\n            localStorage.setItem('token', response.accessToken);\r\n            this.setAuth(true);\r\n            this.setUser(response.user)\r\n            this.getNotes();\r\n\r\n        } catch (error) {\r\n            return error.response.data;\r\n        }\r\n    }\r\n\r\n    async registration(email, password, name) {\r\n        try {\r\n            const response = await AuthService.registration(email, password, name);\r\n            console.log(response);\r\n            localStorage.setItem('token', response.accessToken);\r\n            this.setAuth(true);\r\n            this.setUser(response.user);\r\n        } catch (error) {\r\n            return error.response.data;\r\n        }\r\n    }\r\n    async logout() {\r\n        try {\r\n            console.log('logout')\r\n            await AuthService.logout();\r\n            localStorage.removeItem('token')\r\n            this.setAuth(false);\r\n            this.setUser({});\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n    async checkAuth() {\r\n        try {\r\n            this.getNotes();\r\n            const response = await AuthService.checkAuth();\r\n            localStorage.setItem('token', response.accessToken)\r\n            this.setAuth(true);\r\n            this.setUser(response.user)\r\n            if (this.isAuth) {//если пользователь залогинен, запустить синхронизацию с сервером\r\n                await this.syncWithServer()\r\n            }\r\n        } catch (error) {\r\n\r\n        }\r\n    }\r\n\r\n    async sendResetPasswordEmail(email) {\r\n        try {\r\n            const response = await AuthService.sendResetPasswordEmail(email);\r\n            console.log(response)\r\n        } catch (error) {\r\n            return error.response.data;\r\n        }\r\n    }\r\n\r\n    //notes\r\n    async getNotes() {\r\n        const LocalNotes = await localdb.getAll()\r\n        console.log(LocalNotes)\r\n        this.setNotes(LocalNotes);//независимо от доступности сервера берем заметки из localdb\r\n        noteService.get().then(res => { //если сервер доступен проверяем нет ли новых заметок от сервера, если есть добавляем в бд и обновляем ьассив\r\n            if (res.status == 200) {\r\n                res.data.forEach(async serverNote => { //проходимся по каждой заметки из сервера и проверяем по _id есть ли она в локальной бд\r\n                    const isSynced = LocalNotes.find(element => element._id == serverNote._id)\r\n                    if (isSynced == undefined) await localdb.put({ ...serverNote, status: 'sync' })\r\n                });\r\n                this.setNotes(LocalNotes);\r\n            }\r\n\r\n        })\r\n\r\n    }\r\n    async editNote(note, sync) {\r\n        try {\r\n            //await service.noteChange(editedNote)\r\n            localdb.put({ ...note, status: 'edit' })//сначала изменяем заметку в локалбд и стейте, если сервер доступен синхронизируемся с ним\r\n            this.setNotes(this.notes.map(elem => elem._id == note._id ? elem = note : elem))\r\n            noteService.edit(note).then(res => {\r\n                if (res.status == 200) {\r\n                    localdb.put({ ...res.data, status: 'sync' })\r\n                }\r\n            })\r\n\r\n\r\n\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n        finally {\r\n        }\r\n\r\n\r\n    }\r\n    async AddNote(note, sync) {\r\n        try {\r\n            // setIsSync(true)\r\n            const localNote = { ...note, status: 'new', _id: new Date() } //сначала создаем заметку в бд\r\n            await localdb.put(localNote)\r\n            this.setNotes([...this.notes, localNote])\r\n            noteService.add(note).then(res => { //если сервер доступен удаляем заметку из notes и меняем ее на валидную\r\n                if (res.status == 200) {\r\n                    const syncNote = res.data;\r\n                    const notes = this.notes.filter(e => e._id !== localNote._id)\r\n                    localdb.delete(localNote._id)\r\n                    localdb.put({ ...syncNote, status: 'sync' })\r\n                    this.setNotes([...notes, syncNote])\r\n                }\r\n            })\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n        finally {\r\n            //setIsSync(false)\r\n        }\r\n\r\n    }\r\n    async RemoveNote(note, sync) {\r\n        try {\r\n            await noteService.delete(note)\r\n            const notes = this.notes.filter(e => e._id !== note._id)\r\n            this.setNotes(notes)\r\n        } catch (error) {\r\n\r\n        }\r\n    }\r\n    async syncWithServer() {\r\n\r\n        noteService.get().then(async res => { //если сервер доступен синхронизируем локалбд и сервер\r\n            if (res.status == 200) {\r\n                const localNotes = await localdb.getAll();//получаем заметки из локалдб и проверяем их статус синхронизации\r\n                localNotes.forEach(async note => {\r\n\r\n                    if(note.status == 'edit') {\r\n                        const SyncedEdit = await noteService.edit(note)\r\n                        if (SyncedEdit.status == 200) {\r\n                            console.log('its work')\r\n                            await localdb.put({ ...SyncedEdit.data, status: 'sync' })\r\n                        }\r\n                    }\r\n                    else if(note.status == 'new') {\r\n                        const SyncedNew = await noteService.add(note)\r\n                        if (SyncedNew.status == 200) {\r\n                            await localdb.delete(note._id)\r\n                            await localdb.put({ ...SyncedNew.data, status: 'sync' })\r\n                        }\r\n                        }\r\n\r\n                })\r\n            }\r\n\r\n        })\r\n    }\r\n    NoteSearch(search) {\r\n        const notes = this.notes.filter(note => note.title.toLowerCase().includes(search.toLowerCase()))\r\n            .concat(this.notes.filter(note => note.body.toLowerCase().includes(search.toLowerCase())))\r\n        this.setSearchedNotes(notes);\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}