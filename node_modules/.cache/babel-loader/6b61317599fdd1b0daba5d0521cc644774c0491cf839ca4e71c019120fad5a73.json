{"ast":null,"code":"import axios from'axios';//export const API_URL = 'http://localhost:5000/api';\nexport const API_URL='/api';const $api=axios.create({withCredentials:true,baseURL:API_URL});$api.interceptors.request.use(config=>{config.headers.Authorization=\"Bearer \".concat(localStorage.getItem('token'));return config;});$api.interceptors.response.use(config=>{return config;},async error=>{const originalRequest=error.config;if(error.response.status==401){const response=await axios.get(\"\".concat(API_URL,\"/auth/refresh\"),{withCredentials:true});localStorage.setItem('token',response.data.accessToken);return $api.request(originalRequest);}else{throw error;}});export default $api;","map":{"version":3,"names":["axios","API_URL","$api","create","withCredentials","baseURL","interceptors","request","use","config","headers","Authorization","concat","localStorage","getItem","response","error","originalRequest","status","get","setItem","data","accessToken"],"sources":["C:/Users/vasja/coding/notes_pwa/src/http/index.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n//export const API_URL = 'http://localhost:5000/api';\r\nexport const API_URL = '/api';\r\nconst $api = axios.create({\r\n    withCredentials: true,\r\n    baseURL: API_URL\r\n});\r\n\r\n$api.interceptors.request.use((config) => {\r\n    config.headers.Authorization = `Bearer ${localStorage.getItem('token')}`;\r\n    return config;\r\n\r\n})\r\n\r\n$api.interceptors.response.use((config) => {\r\n    return config;\r\n},\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n        if (error.response.status == 401) {\r\n            const response = await axios.get(`${API_URL}/auth/refresh`, {withCredentials: true});\r\n            localStorage.setItem('token', response.data.accessToken);\r\n            return $api.request(originalRequest);\r\n        }\r\n        else{ throw error}\r\n    }\r\n)\r\n\r\nexport default $api;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB;AACA,MAAO,MAAM,CAAAC,OAAO,CAAG,MAAM,CAC7B,KAAM,CAAAC,IAAI,CAAGF,KAAK,CAACG,MAAM,CAAC,CACtBC,eAAe,CAAE,IAAI,CACrBC,OAAO,CAAEJ,OACb,CAAC,CAAC,CAEFC,IAAI,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,EAAK,CACtCA,MAAM,CAACC,OAAO,CAACC,aAAa,WAAAC,MAAA,CAAaC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxE,MAAO,CAAAL,MAAM,CAEjB,CAAC,CAAC,CAEFP,IAAI,CAACI,YAAY,CAACS,QAAQ,CAACP,GAAG,CAAEC,MAAM,EAAK,CACvC,MAAO,CAAAA,MAAM,CACjB,CAAC,CACG,KAAO,CAAAO,KAAK,EAAK,CACb,KAAM,CAAAC,eAAe,CAAGD,KAAK,CAACP,MAAM,CACpC,GAAIO,KAAK,CAACD,QAAQ,CAACG,MAAM,EAAI,GAAG,CAAE,CAC9B,KAAM,CAAAH,QAAQ,CAAG,KAAM,CAAAf,KAAK,CAACmB,GAAG,IAAAP,MAAA,CAAIX,OAAO,kBAAiB,CAACG,eAAe,CAAE,IAAI,CAAC,CAAC,CACpFS,YAAY,CAACO,OAAO,CAAC,OAAO,CAAEL,QAAQ,CAACM,IAAI,CAACC,WAAW,CAAC,CACxD,MAAO,CAAApB,IAAI,CAACK,OAAO,CAACU,eAAe,CAAC,CACxC,CAAC,IACG,CAAE,KAAM,CAAAD,KAAK,EACrB,CACJ,CAAC,CAED,cAAe,CAAAd,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}