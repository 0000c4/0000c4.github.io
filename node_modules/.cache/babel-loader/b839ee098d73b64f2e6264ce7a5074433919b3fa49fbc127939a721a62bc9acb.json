{"ast":null,"code":"import axios from'axios';//export const API_URL = 'http://localhost:5000/api';\nexport const API_URL='/api';const $api=axios.create({withCredentials:true,baseURL:API_URL,timeout:2000});$api.interceptors.request.use(config=>{config.headers.Authorization=\"Bearer \".concat(localStorage.getItem('token'));return config;});$api.interceptors.response.use(config=>{return config;},async error=>{var _error$response;const originalRequest=error.config;if(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)==401){const response=await axios.get(\"\".concat(API_URL,\"/auth/refresh\"),{withCredentials:true});localStorage.setItem('token',response.data.accessToken);return $api.request(originalRequest);}else{throw error;}});export default $api;","map":{"version":3,"names":["axios","API_URL","$api","create","withCredentials","baseURL","timeout","interceptors","request","use","config","headers","Authorization","concat","localStorage","getItem","response","error","_error$response","originalRequest","status","get","setItem","data","accessToken"],"sources":["C:/Users/vasja/coding/notes_pwa/src/http/index.js"],"sourcesContent":["import axios from 'axios';\r\n\r\n//export const API_URL = 'http://localhost:5000/api';\r\nexport const API_URL = '/api';\r\nconst $api = axios.create({\r\n    withCredentials: true,\r\n    baseURL: API_URL,\r\n    timeout: 2000\r\n});\r\n\r\n$api.interceptors.request.use((config) => {\r\n    config.headers.Authorization = `Bearer ${localStorage.getItem('token')}`;\r\n    return config;\r\n\r\n})\r\n\r\n$api.interceptors.response.use((config) => {\r\n    return config;\r\n},\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n        if (error.response?.status == 401) {\r\n            const response = await axios.get(`${API_URL}/auth/refresh`, {withCredentials: true});\r\n            localStorage.setItem('token', response.data.accessToken);\r\n            return $api.request(originalRequest);\r\n        }\r\n        else{ throw error}\r\n    }\r\n)\r\n\r\nexport default $api;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB;AACA,MAAO,MAAM,CAAAC,OAAO,CAAG,MAAM,CAC7B,KAAM,CAAAC,IAAI,CAAGF,KAAK,CAACG,MAAM,CAAC,CACtBC,eAAe,CAAE,IAAI,CACrBC,OAAO,CAAEJ,OAAO,CAChBK,OAAO,CAAE,IACb,CAAC,CAAC,CAEFJ,IAAI,CAACK,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,EAAK,CACtCA,MAAM,CAACC,OAAO,CAACC,aAAa,WAAAC,MAAA,CAAaC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACxE,MAAO,CAAAL,MAAM,CAEjB,CAAC,CAAC,CAEFR,IAAI,CAACK,YAAY,CAACS,QAAQ,CAACP,GAAG,CAAEC,MAAM,EAAK,CACvC,MAAO,CAAAA,MAAM,CACjB,CAAC,CACG,KAAO,CAAAO,KAAK,EAAK,KAAAC,eAAA,CACb,KAAM,CAAAC,eAAe,CAAGF,KAAK,CAACP,MAAM,CACpC,GAAI,EAAAQ,eAAA,CAAAD,KAAK,CAACD,QAAQ,UAAAE,eAAA,iBAAdA,eAAA,CAAgBE,MAAM,GAAI,GAAG,CAAE,CAC/B,KAAM,CAAAJ,QAAQ,CAAG,KAAM,CAAAhB,KAAK,CAACqB,GAAG,IAAAR,MAAA,CAAIZ,OAAO,kBAAiB,CAACG,eAAe,CAAE,IAAI,CAAC,CAAC,CACpFU,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAEN,QAAQ,CAACO,IAAI,CAACC,WAAW,CAAC,CACxD,MAAO,CAAAtB,IAAI,CAACM,OAAO,CAACW,eAAe,CAAC,CACxC,CAAC,IACG,CAAE,KAAM,CAAAF,KAAK,EACrB,CACJ,CAAC,CAED,cAAe,CAAAf,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}